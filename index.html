<!DOCTYPE html>
<html lang="mk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Архитектонски Квиз за Недвижности</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@200;300;400;700;800&display=swap" rel="stylesheet" />

  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: { sans: ["Manrope", "sans-serif"] },
          colors: {
            glass: "rgba(255, 255, 255, 0.6)",
            "glass-hover": "rgba(255, 255, 255, 0.8)",
            "glass-border": "rgba(255, 255, 255, 0.4)",
          },
          animation: {
            "fade-in": "fadeIn 0.6s cubic-bezier(0.16, 1, 0.3, 1) forwards",
            "slide-up": "slideUp 0.7s cubic-bezier(0.16, 1, 0.3, 1) forwards",
            liquid: "liquid 12s ease-in-out infinite",
          },
          keyframes: {
            fadeIn: { "0%": { opacity: "0" }, "100%": { opacity: "1" } },
            slideUp: {
              "0%": { opacity: "0", transform: "translateY(20px)" },
              "100%": { opacity: "1", transform: "translateY(0)" },
            },
            liquid: {
              "0%, 100%": { transform: "translate(0, 0) rotate(0deg)" },
              "25%": { transform: "translate(10px, 15px) rotate(2deg)" },
              "50%": { transform: "translate(-5px, 20px) rotate(-1deg)" },
              "75%": { transform: "translate(-15px, 5px) rotate(1deg)" },
            },
          },
        },
      },
    };
  </script>

  <style>
    body { background-color: #f2f4f6; color: #1a1a1a; overflow-x: hidden; }

    .orb {
      position: fixed; border-radius: 50%; filter: blur(80px);
      z-index: -1; opacity: 0.6; animation: liquid 20s infinite;
    }
    .orb-1 {
      top: -10%; left: -10%; width: 60vw; height: 60vw;
      background: radial-gradient(circle, #e2e8f0 0%, transparent 70%);
    }
    .orb-2 {
      bottom: -20%; right: -10%; width: 70vw; height: 70vw;
      background: radial-gradient(circle, #cbd5e1 0%, transparent 70%);
      animation-delay: -5s;
    }

    .grid-bg {
      position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      background-image:
        linear-gradient(to right, rgba(0, 0, 0, 0.03) 1px, transparent 1px),
        linear-gradient(to bottom, rgba(0, 0, 0, 0.03) 1px, transparent 1px);
      background-size: 60px 60px; z-index: -1;
      mask-image: radial-gradient(circle at center, black 40%, transparent 100%);
    }

    .glass-panel {
      background: rgba(255, 255, 255, 0.65);
      backdrop-filter: blur(24px); -webkit-backdrop-filter: blur(24px);
      border: 1px solid rgba(255, 255, 255, 0.9);
      box-shadow:
        0 10px 40px -10px rgba(0, 0, 0, 0.05),
        0 0 0 1px rgba(255, 255, 255, 0.5) inset;
    }

    ::-webkit-scrollbar { width: 6px; }
    ::-webkit-scrollbar-track { background: #f1f1f1; }
    ::-webkit-scrollbar-thumb { background: #ccc; border-radius: 3px; }

    .arch-input {
      background: transparent;
      border-bottom: 1px solid rgba(0, 0, 0, 0.2);
      transition: all 0.3s ease; color: #000;
    }
    .arch-input:focus {
      outline: none; border-bottom: 1px solid #000;
      background: rgba(0, 0, 0, 0.02);
    }
    .arch-input::placeholder { color: rgba(0, 0, 0, 0.3); }

    .hidden-step { display: none; opacity: 0; transform: scale(0.99); }
    .active-step { display: flex; opacity: 1; transform: scale(1); }

    .option-card:hover {
      background-color: #ffffff;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05);
      border-color: rgba(0, 0, 0, 0.1);
    }
    .option-card:hover .check-circle { background-color: black; border-color: black; }

    /* Faster transitions to remove perceived delay */
    #question-text, #question-subtext, #options-grid { transition: opacity 120ms ease; }
  </style>
</head>

<body class="min-h-screen flex items-center justify-center p-4 relative selection:bg-black selection:text-white">
  <div class="grid-bg"></div>
  <div class="orb orb-1"></div>
  <div class="orb orb-2"></div>

  <main class="w-full max-w-2xl glass-panel rounded-[32px] p-8 md:p-12 relative overflow-hidden min-h-[650px] flex flex-col">
    <div class="w-full flex justify-center relative z-20 -mt-4 mb-4">
      <img src="https://goldenart.mk/wp-content/uploads/2025/09/logoshadow-600x257.png" alt="Golden Art Logo" class="h-28 object-contain opacity-90">
    </div>

    <div class="absolute top-0 left-8 w-[1px] h-20 bg-gradient-to-b from-black/10 to-transparent"></div>
    <div class="absolute bottom-0 right-8 w-[1px] h-20 bg-gradient-to-t from-black/10 to-transparent"></div>
    <div class="absolute top-8 left-0 w-20 h-[1px] bg-gradient-to-r from-black/10 to-transparent"></div>
    <div class="absolute bottom-8 right-0 w-20 h-[1px] bg-gradient-to-l from-black/10 to-transparent"></div>

    <div id="progress-container" class="absolute top-0 left-0 w-full h-1 bg-black/5 hidden z-30">
      <div id="progress-bar" class="h-full bg-black transition-all duration-500 ease-out w-0 shadow-[0_0_10px_rgba(0,0,0,0.1)]"></div>
    </div>

    <div id="content-area" class="relative z-10 w-full flex-grow flex flex-col justify-center">

      <div id="step-start" class="active-step flex-col items-start justify-center h-full space-y-8 animate-fade-in py-4">
        <h1 class="text-5xl md:text-7xl font-extrabold tracking-tighter leading-[0.95] text-gray-900">
          Кој стан или деловен простор <br />
          <span class="text-transparent bg-clip-text bg-gradient-to-r from-black to-black/40 font-light italic pr-2 pb-1 inline-block">е идеален за вас?</span>
        </h1>

        <p class="text-gray-600 font-light text-lg max-w-md border-l border-black/10 pl-6 py-2">
          Откријте го вашиот совршен простор со неколку кликови.
        </p>

        <button onclick="startQuiz()" class="group relative px-8 py-4 bg-black text-white font-bold tracking-widest uppercase text-sm overflow-hidden transition-all hover:pr-12 rounded-lg shadow-lg hover:shadow-xl">
          <span class="relative z-10">Започни</span>
          <span class="absolute right-4 top-1/2 -translate-y-1/2 opacity-0 group-hover:opacity-100 transition-all duration-300">→</span>
          <div class="absolute inset-0 bg-white/0 group-hover:bg-white/20 transition-colors"></div>
        </button>
      </div>

      <div id="quiz-container" class="hidden-step flex-col h-full py-2">
        <div class="mb-6 flex justify-between items-end">
          <span class="text-xs font-bold tracking-[0.2em] text-black/40 uppercase block mb-2">
            Прашање <span id="current-q-num">1</span>/<span id="total-q-num">6</span>
          </span>
          <button id="back-btn" onclick="goBack()" class="text-xs text-black/30 hover:text-black transition-colors">НАЗАД</button>
        </div>

        <h2 id="question-text" class="text-3xl md:text-4xl font-bold mb-5 leading-tight text-gray-900 min-h-[80px]"></h2>
        <p id="question-subtext" class="text-gray-500 font-light mb-6 hidden"></p>

        <div id="options-grid" class="grid grid-cols-1 md:grid-cols-2 gap-3 w-full"></div>
      </div>

      <div id="step-contact" class="hidden-step flex-col h-full animate-slide-up py-4">
        <span class="text-xs font-bold tracking-[0.2em] text-black/40 uppercase mb-6 block">Финален чекор</span>
        <h2 class="text-3xl md:text-4xl font-bold mb-2 text-gray-900">Контакт</h2>
        <p class="text-gray-500 font-light mb-8">
          Пополнете ја формата и ќе откриете кој стан или деловен простор е идеален за вашите потреби.
        </p>

        <form id="contact-form" onsubmit="submitForm(event)" class="space-y-6 w-full max-w-md">
          <div class="group">
            <label class="block text-xs font-bold tracking-widest text-black/40 uppercase mb-2 group-focus-within:text-black transition-colors">Име и презиме</label>
            <input id="fullName" type="text" required class="arch-input w-full py-2 text-xl font-light text-black placeholder-black/20" placeholder="Вашето име" />
          </div>

          <div class="group">
            <label class="block text-xs font-bold tracking-widest text-black/40 uppercase mb-2 group-focus-within:text-black transition-colors">Телефон</label>
            <input id="phone" type="tel" required class="arch-input w-full py-2 text-xl font-light text-black placeholder-black/20" placeholder="07x xxx xxx" />
          </div>

          <div class="group">
            <label class="block text-xs font-bold tracking-widest text-black/40 uppercase mb-2 group-focus-within:text-black transition-colors">Email</label>
            <input id="email" type="email" required class="arch-input w-full py-2 text-xl font-light text-black placeholder-black/20" placeholder="email@example.com" />
          </div>

          <button type="submit" class="w-full mt-6 bg-black text-white font-bold py-4 px-6 tracking-widest uppercase text-sm hover:bg-gray-800 transition-all flex justify-between items-center group rounded-lg shadow-lg hover:shadow-xl">
            <span>Испрати Барање</span>
            <span class="transform group-hover:translate-x-2 transition-transform">→</span>
          </button>
        </form>
      </div>

      <div id="step-success" class="hidden-step flex-col items-center justify-center text-center h-full animate-slide-up py-10">
        <div class="w-20 h-20 border border-black/10 bg-white/50 rounded-full flex items-center justify-center mb-8 relative shadow-sm">
          <div class="absolute inset-0 bg-black/5 rounded-full animate-ping"></div>
          <svg class="w-8 h-8 text-black" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M5 13l4 4L19 7"></path>
          </svg>
        </div>
        <h2 class="text-4xl font-extrabold mb-4 text-gray-900">Ви благодариме</h2>
        <p class="text-gray-500 font-light max-w-md">
          Ви благодариме. Ќе ви предложиме недвижности кои најдобро одговараат на вашите потреби.
        </p>
        <button onclick="location.reload()" class="mt-12 text-xs font-bold tracking-widest text-black/40 hover:text-black border-b border-transparent hover:border-black transition-all pb-1 uppercase">
          Започни одново
        </button>
      </div>

    </div>
  </main>

  <script>
    // Quiz Data (6 questions) + conditional logic for Q2 and Q3
    const questions = [
      {
        question: "1. За каков тип на недвижност сте заинтересирани?",
        options: ["Стан или апартман", "Деловен простор", "Сѐ уште разгледувам, сакам препорака"],
      },
      {
        question: "2. Кoja локација ви одговара?",
        subtext: "(Покажуваме само соодветни опции според изборот од Прашање 1)",
        conditional: true,
        optionsApartment: [
          "Скопје - Треска",
          "Скопје - Ентрада",
          "Охрид - Парк Охрид",
          "Не сум сигурен, сакам препорака",
        ],
        optionsBusiness: [
          "Скопје - Треска",
          "Скопје - Каредо",
          "Скопје - 4 Степени",
          "Скопје - Ентрада",
          "Охрид - Парк Охрид",
          "Не сум сигурен, сакам препорака",
        ],
        optionsFallback: ["Не сум сигурен, сакам препорака"],
      },
      {
        question: "3. Каков тип простор барате?",
        subtext: "(Покажуваме само соодветни опции според изборот од Прашање 1)",
        conditional: true,
        optionsApartment: ["Гарсоњера", "Еднособен", "Двособен", "Трособен", "Четирисобен"],
        optionsBusiness: ["Локал", "Изложбен салон", "Канцеларија", "Магацински простор"],
        optionsFallback: ["Сакам препорака"],
      },
      {
        question: "4. Кој опсег на големина го преферирате?",
        options: ["Под 40 m²", "40-60 m²", "60-80 m²", "80-120 m²", "120+ m²"],
      },
      {
        question: "5. Кога планирате да купите?",
        options: ["Во следниве 30 дена", "Во следниве 3 месеци", "Во следниве 6 месеци", "Подоцна / само истражувам"],
      },
      {
        question: "6. Кој е вашиот приближен буџет?",
        options: ["Под 70.000 €", "70.000 - 100.000 €", "100.000 - 150.000 €", "150.000 - 200.000 €", "Над 200.000 €"],
      },
    ];

    let currentStep = 0; // 0=Start, 1..6=Questions, 7=Contact, 8=Success
    let answers = [];
    let isTransitioning = false;

    const stepStart = document.getElementById("step-start");
    const quizContainer = document.getElementById("quiz-container");
    const stepContact = document.getElementById("step-contact");
    const stepSuccess = document.getElementById("step-success");
    const progressContainer = document.getElementById("progress-container");
    const progressBar = document.getElementById("progress-bar");

    const questionText = document.getElementById("question-text");
    const questionSubtext = document.getElementById("question-subtext");
    const optionsGrid = document.getElementById("options-grid");
    const currentQNum = document.getElementById("current-q-num");
    const totalQNum = document.getElementById("total-q-num");
    const backBtn = document.getElementById("back-btn");

    totalQNum.innerText = questions.length;

    function startQuiz() {
      switchView(stepStart, quizContainer);
      progressContainer.classList.remove("hidden");
      currentStep = 1;
      loadQuestion(0, true);
    }

    function getTypeFromQ1() {
      const firstAnswer = answers[0] || "";
      if (firstAnswer.includes("Стан")) return "apartment";
      if (firstAnswer.includes("Деловен")) return "business";
      return "unknown";
    }

    function getOptionsForIndex(index) {
      const q = questions[index];

      if (q.conditional) {
        const type = getTypeFromQ1();
        if (type === "apartment") return q.optionsApartment || q.optionsFallback || [];
        if (type === "business") return q.optionsBusiness || q.optionsFallback || [];
        return q.optionsFallback || [];
      }

      return q.options || [];
    }

    // No artificial timeout: update immediately on next animation frame
    function loadQuestion(index, immediate) {
      const progress = ((index + 1) / questions.length) * 100;
      progressBar.style.width = `${progress}%`;
      currentQNum.innerText = index + 1;

      // Back button behavior: if on first question, back goes to start
      backBtn.innerText = (index === 0) ? "НАЗАД" : "НАЗАД";

      if (!immediate) {
        questionText.style.opacity = 0;
        optionsGrid.style.opacity = 0;
        questionSubtext.style.opacity = 0;
      }

      const render = () => {
        const q = questions[index];
        questionText.innerText = q.question;

        if (q.subtext) {
          questionSubtext.classList.remove("hidden");
          questionSubtext.innerText = q.subtext;
        } else {
          questionSubtext.classList.add("hidden");
          questionSubtext.innerText = "";
        }

        const opts = getOptionsForIndex(index);
        optionsGrid.innerHTML = "";
        opts.forEach((opt) => {
          const btn = document.createElement("button");
          btn.type = "button";
          btn.className = `
            option-card text-left p-5 border border-black/5 bg-white/40
            hover:bg-white hover:border-black/10 transition-all duration-200
            group flex items-center justify-between backdrop-blur-sm rounded-xl
          `;
          btn.onclick = () => selectOption(opt);

          btn.innerHTML = `
            <span class="font-normal text-lg text-gray-800 group-hover:text-black">${opt}</span>
            <div class="check-circle w-4 h-4 rounded-full border border-black/20 transition-all duration-200"></div>
          `;
          optionsGrid.appendChild(btn);
        });

        // Fade back in quickly
        requestAnimationFrame(() => {
          questionText.style.opacity = 1;
          optionsGrid.style.opacity = 1;
          if (!questionSubtext.classList.contains("hidden")) questionSubtext.style.opacity = 1;
        });
      };

      if (immediate) {
        render();
        return;
      }

      requestAnimationFrame(render);
    }

    function selectOption(answer) {
      if (isTransitioning) return;
      isTransitioning = true;

      answers.push(answer);

      if (currentStep < questions.length) {
        currentStep++;
        loadQuestion(currentStep - 1, false);
        // release lock fast, without delaying UX
        setTimeout(() => { isTransitioning = false; }, 140);
      } else {
        finishQuiz();
        setTimeout(() => { isTransitioning = false; }, 140);
      }
    }

    function goBack() {
      if (isTransitioning) return;
      isTransitioning = true;

      // If we're on question 1 (index 0), go back to start screen
      if (currentStep === 1) {
        resetQuiz();
        setTimeout(() => { isTransitioning = false; }, 140);
        return;
      }

      // Otherwise, go to previous question
      if (currentStep > 1) {
        // remove last answer
        answers.pop();
        currentStep--;
        loadQuestion(currentStep - 1, false);
      }

      setTimeout(() => { isTransitioning = false; }, 140);
    }

    function finishQuiz() {
      switchView(quizContainer, stepContact);
      progressBar.style.width = "100%";
    }

    function submitForm(e) {
      e.preventDefault();

      const btn = e.target.querySelector("button[type='submit']");
      const originalHTML = btn.innerHTML;
      btn.innerHTML = "<span class='animate-pulse'>Обработка...</span>";
      btn.disabled = true;

      setTimeout(() => {
        switchView(stepContact, stepSuccess);
        progressContainer.classList.add("hidden");
        btn.innerHTML = originalHTML;
        btn.disabled = false;
      }, 900);
    }

    function resetQuiz() {
      answers = [];
      currentStep = 0;
      progressBar.style.width = "0%";
      progressContainer.classList.add("hidden");

      quizContainer.classList.remove("active-step");
      quizContainer.classList.add("hidden-step");
      stepContact.classList.remove("active-step");
      stepContact.classList.add("hidden-step");
      stepSuccess.classList.remove("active-step");
      stepSuccess.classList.add("hidden-step");

      stepStart.classList.remove("hidden-step");
      stepStart.classList.add("active-step");
    }

    function switchView(from, to) {
      from.style.opacity = "0";
      from.style.transform = "translateY(-10px)";

      setTimeout(() => {
        from.classList.remove("active-step");
        from.classList.add("hidden-step");
        from.style.transform = "";

        to.classList.remove("hidden-step");
        to.classList.add("active-step");

        void to.offsetWidth;

        to.style.opacity = "1";
      }, 220);
    }
  </script>
</body>
</html>
